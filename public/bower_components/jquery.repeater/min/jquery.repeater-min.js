!function($){"use strict";var t=function(t){return t},e=function(t){return $.isArray(t)},n=function(t){return!e(t)&&t instanceof Object},r=function(t){return t instanceof Number},i=function(t){return t instanceof Function},u=function(t,e){return $.inArray(e,t)},a=function(t,e){return u(t,e)!==-1},c=function(t,e){for(var n in t)t.hasOwnProperty(n)&&e(t[n],n,t)},o=function(t){return t[t.length-1]},f=function(t){return Array.prototype.slice.call(t)},s=function(){var t={};return c(f(arguments),function(e){c(e,function(e,n){t[n]=e})}),t},p=function(t,e){var n=[];return c(t,function(t,r,i){n.push(e(t,r,i))}),n},l=function(t,e,n){var r={};return c(t,function(t,i,u){i=n?n(i,t):i,r[i]=e(t,i,u)}),r},h=function(t,n,r){return e(t)?p(t,n):l(t,n,r)},d=function(t,e){return h(t,function(t){return t[e]})},v=function(t,n){var r;return e(t)?(r=[],c(t,function(t,e,i){n(t,e,i)&&r.push(t)})):(r={},c(t,function(t,e,i){n(t,e,i)&&(r[e]=t)})),r},m=function(t,e,n){return h(t,function(t,r){return t[e].apply(t,n||[])})},g=function(t,e){var n=null;return function(){var r=this,i=arguments;null===n&&(n=setTimeout(function(){n=null},t),e.apply(r,i))}},y=function(t){t=t||{};var e={};return t.publish=function(t,n){c(e[t],function(t){t(n)})},t.subscribe=function(t,n){e[t]=e[t]||[],e[t].push(n)},t.unsubscribe=function(t){c(e,function(e){var n=u(e,t);n!==-1&&e.splice(n,1)})},t};!function($){var t=function(t,e){var n=y(),r=t.$;return n.getType=function(){throw'implement me (return type. "text", "radio", etc.)'},n.$=function(t){return t?r.find(t):r},n.disable=function(){n.$().prop("disabled",!0),n.publish("isEnabled",!1)},n.enable=function(){n.$().prop("disabled",!1),n.publish("isEnabled",!0)},e.equalTo=function(t,e){return t===e},e.publishChange=function(){var t;return function(r,i){var u=n.get();e.equalTo(u,t)||n.publish("change",{e:r,domElement:i}),t=u}}(),n},r=function(e,n){var r=t(e,n);return r.get=function(){return r.$().val()},r.set=function(t){r.$().val(t)},r.clear=function(){r.set("")},n.buildSetter=function(t){return function(e){t.call(r,e)}},r},i=function(t,n){t=e(t)?t:[t],n=e(n)?n:[n];var r=!0;return t.length!==n.length?r=!1:c(t,function(t){a(n,t)||(r=!1)}),r},f=function(t){var e={},n=r(t,e);return n.getType=function(){return"button"},n.$().on("change",function(t){e.publishChange(t,this)}),n},s=function(t){var n={},u=r(t,n);return u.getType=function(){return"checkbox"},u.get=function(){var t=[];return u.$().filter(":checked").each(function(){t.push($(this).val())}),t},u.set=function(t){t=e(t)?t:[t],u.$().each(function(){$(this).prop("checked",!1)}),c(t,function(t){u.$().filter('[value="'+t+'"]').prop("checked",!0)})},n.equalTo=i,u.$().change(function(t){n.publishChange(t,this)}),u},p=function(t){var e={},n=T(t,e);return n.getType=function(){return"email"},n},l=function(e){var n={},r=t(e,n);return r.getType=function(){return"file"},r.get=function(){return o(r.$().val().split("\\"))},r.clear=function(){this.$().each(function(){$(this).wrap("<form>").closest("form").get(0).reset(),$(this).unwrap()})},r.$().change(function(t){n.publishChange(t,this)}),r},h=function(t){var e={},n=r(t,e);return n.getType=function(){return"hidden"},n.$().change(function(t){e.publishChange(t,this)}),n},d=function(e){var n={},r=t(e,n);return r.getType=function(){return"file[multiple]"},r.get=function(){var t=r.$().get(0).files||[],e=[],n;for(n=0;n<(t.length||0);n+=1)e.push(t[n].name);return e},r.clear=function(){this.$().each(function(){$(this).wrap("<form>").closest("form").get(0).reset(),$(this).unwrap()})},r.$().change(function(t){n.publishChange(t,this)}),r},v=function(t){var n={},u=r(t,n);return u.getType=function(){return"select[multiple]"},u.get=function(){return u.$().val()||[]},u.set=function(t){u.$().val(""===t?[]:e(t)?t:[t])},n.equalTo=i,u.$().change(function(t){n.publishChange(t,this)}),u},g=function(t){var e={},n=T(t,e);return n.getType=function(){return"password"},n},b=function(t){var e={},n=r(t,e);return n.getType=function(){return"radio"},n.get=function(){return n.$().filter(":checked").val()||null},n.set=function(t){t?n.$().filter('[value="'+t+'"]').prop("checked",!0):n.$().each(function(){$(this).prop("checked",!1)})},n.$().change(function(t){e.publishChange(t,this)}),n},k=function(t){var e={},n=r(t,e);return n.getType=function(){return"range"},n.$().change(function(t){e.publishChange(t,this)}),n},x=function(t){var e={},n=r(t,e);return n.getType=function(){return"select"},n.$().change(function(t){e.publishChange(t,this)}),n},T=function(t){var e={},n=r(t,e);return n.getType=function(){return"text"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n},w=function(t){var e={},n=r(t,e);return n.getType=function(){return"textarea"},n.$().on("change keyup keydown",function(t){e.publishChange(t,this)}),n},C=function(t){var e={},n=T(t,e);return n.getType=function(){return"url"},n},V=function(t){var e={},r=t.$,i=t.constructorOverride||{button:f,text:T,url:C,email:p,password:g,range:k,textarea:w,select:x,"select[multiple]":v,radio:b,checkbox:s,file:l,"file[multiple]":d,hidden:h},a=function(t,u){var a=n(u)?u:r.find(u);a.each(function(){var n=$(this).attr("name");e[n]=i[t]({$:$(this)})})},o=function(t,a){var o=[],f=n(a)?a:r.find(a);n(a)?e[f.attr("name")]=i[t]({$:f}):(f.each(function(){u(o,$(this).attr("name"))===-1&&o.push($(this).attr("name"))}),c(o,function(n){e[n]=i[t]({$:r.find('input[name="'+n+'"]')})}))};return r.is("input, select, textarea")?r.is('input[type="button"], button, input[type="submit"]')?a("button",r):r.is("textarea")?a("textarea",r):r.is('input[type="text"]')||r.is("input")&&!r.attr("type")?a("text",r):r.is('input[type="password"]')?a("password",r):r.is('input[type="email"]')?a("email",r):r.is('input[type="url"]')?a("url",r):r.is('input[type="range"]')?a("range",r):r.is("select")?r.is("[multiple]")?a("select[multiple]",r):a("select",r):r.is('input[type="file"]')?r.is("[multiple]")?a("file[multiple]",r):a("file",r):r.is('input[type="hidden"]')?a("hidden",r):r.is('input[type="radio"]')?o("radio",r):r.is('input[type="checkbox"]')?o("checkbox",r):a("text",r):(a("button",'input[type="button"], button, input[type="submit"]'),a("text",'input[type="text"]'),a("password",'input[type="password"]'),a("email",'input[type="email"]'),a("url",'input[type="url"]'),a("range",'input[type="range"]'),a("textarea","textarea"),a("select","select:not([multiple])"),a("select[multiple]","select[multiple]"),a("file",'input[type="file"]:not([multiple])'),a("file[multiple]",'input[type="file"][multiple]'),a("hidden",'input[type="hidden"]'),o("radio",'input[type="radio"]'),o("checkbox",'input[type="checkbox"]')),e};$.fn.inputVal=function(t){var e=$(this),n=V({$:e});return e.is("input, textarea, select")?"undefined"==typeof t?n[e.attr("name")].get():(n[e.attr("name")].set(t),e):"undefined"==typeof t?m(n,"get"):(c(t,function(t,e){n[e].set(t)}),e)},$.fn.inputOnChange=function(t){var e=$(this),n=V({$:e});return c(n,function(e){e.subscribe("change",function(e){t.call(e.domElement,e.e)})}),e},$.fn.inputDisable=function(){var t=$(this);return m(V({$:t}),"disable"),t},$.fn.inputEnable=function(){var t=$(this);return m(V({$:t}),"enable"),t},$.fn.inputClear=function(){var t=$(this);return m(V({$:t}),"clear"),t}}(jQuery),$.fn.repeaterVal=function(){var t=function(t){var e=[];return c(t,function(t,n){var r=[];"undefined"!==n&&(r.push(n.match(/^[^\[]*/)[0]),r=r.concat(h(n.match(/\[[^\]]*\]/g),function(t){return t.replace(/[\[\]]/g,"")})),e.push({val:t,key:r}))}),e},e=function(t){if(1===t.length&&(0===t[0].key.length||1===t[0].key.length&&!t[0].key[0]))return t[0].val;c(t,function(t){t.head=t.key.shift()});var n=function(){var e={};return c(t,function(t){e[t.head]||(e[t.head]=[]),e[t.head].push(t)}),e}(),r;return/^[0-9]+$/.test(t[0].head)?(r=[],c(n,function(t){r.push(e(t))})):(r={},c(n,function(t,n){r[n]=e(t)})),r};return e(t($(this).inputVal()))},$.fn.repeater=function(e){e=e||{};var n;return $(this).each(function(){var r=$(this),i=e.show||function(){$(this).show()},u=e.hide||function(t){t()},a=r.find("[data-repeater-list]").first(),f=function(t,e){return t.filter(function(){return!e||0===$(this).closest(d(e,"selector").join(",")).length})},p=function(){return f(a.find("[data-repeater-item]"),e.repeaters)},l=a.find("[data-repeater-item]").first().clone().hide(),m=f(f($(this).find("[data-repeater-item]"),e.repeaters).first().find("[data-repeater-delete]"),e.repeaters);e.isFirstItemUndeletable&&m&&m.remove();var g=function(){var t=a.data("repeater-list");return e.$parent?e.$parent.data("item-name")+"["+t+"]":t},y=function(t){e.repeaters&&t.each(function(){var t=$(this);c(e.repeaters,function(e){t.find(e.selector).repeater(s(e,{$parent:t}))})})},b=function(t,e,n){t&&c(t,function(t){n.call(e.find(t.selector)[0],t)})},k=function(t,e,n){t.each(function(t){var r=$(this);r.data("item-name",e+"["+t+"]"),f(r.find("[name]"),n).each(function(){var i=$(this),u=i.attr("name").match(/\[[^\]]+\]/g),a=u?o(u).replace(/\[|\]/g,""):i.attr("name"),c=e+"["+t+"]["+a+"]"+(i.is(":checkbox")||i.attr("multiple")?"[]":"");i.attr("name",c),b(n,r,function(n){var r=$(this);k(f(r.find("[data-repeater-item]"),n.repeaters||[]),e+"["+t+"]["+r.find("[data-repeater-list]").first().data("repeater-list")+"]",n.repeaters)})})}),a.find("input[name][checked]").removeAttr("checked").prop("checked",!0)};k(p(),g(),e.repeaters),y(p()),e.initEmpty&&p().remove(),e.ready&&e.ready(function(){k(p(),g(),e.repeaters)});var x=function(){var n=function(r,i,u){if(i||e.defaultValues){var a={};f(r.find("[name]"),u).each(function(){var t=$(this).attr("name").match(/\[([^\]]*)(\]|\]\[\])$/)[1];a[t]=$(this).attr("name")}),r.inputVal(h(v(i||e.defaultValues,function(t,e){return a[e]}),t,function(t){return a[t]}))}b(u,r,function(t){var e=$(this);f(e.find("[data-repeater-item]"),t.repeaters).each(function(){var r=e.find("[data-repeater-list]").data("repeater-list");if(i&&i[r]){var u=$(this).clone();e.find("[data-repeater-item]").remove(),c(i[r],function(r){var i=u.clone();n(i,r,t.repeaters||[]),e.find("[data-repeater-list]").append(i)})}else n($(this),t.defaultValues,t.repeaters||[])})})};return function(t,r){a.append(t),k(p(),g(),e.repeaters),t.find("[name]").each(function(){$(this).inputClear()}),n(t,r||e.defaultValues,e.repeaters)}}(),T=function(t){var n=l.clone();x(n,t),e.repeaters&&y(n),i.call(n.get(0))};n=function(t){p().remove(),c(t,T)},f(r.find("[data-repeater-create]"),e.repeaters).click(function(){T(),event.stopImmediatePropagation()}),a.on("click","[data-repeater-delete]",function(){var t=$(this).closest("[data-repeater-item]").get(0);u.call(t,function(){$(t).remove(),k(p(),g(),e.repeaters)})})}),this.setList=n,this}}(jQuery);